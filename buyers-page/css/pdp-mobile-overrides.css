/* buyers-page/css/pdp-mobile-overrides.css
   MOBILE-ONLY PDP OVERRIDES
   - Title first (gallery immediately after title)
   - Hide thumbnail gallery strip
   - Lock main image viewport with a visible internal scroller
   - Prevent overlap with bullets
   - Buy gadget (buybox) full width, colors exactly like desktop
*/

@media (max-width: 768px) {
  :root{
    --bb-scale: 1 !important;      /* prevent any downscaling on mobile */
    /* JS will set --pdp-frame-h dynamically based on the first imageâ€™s aspect ratio */
  }

  /* Safety: allow inner scroll areas to actually scroll inside flex stacks */
  .pdp-wrap,
  .pdp-grid,
  .pdp-left,
  .pdp-leftgrid{
    min-height: 0 !important;
  }

  /* Single-column stack for PDP */
  .pdp-grid{
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important;
  }
  .pdp-leftgrid{
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important;
  }

  /* ---------- ORDERING (mobile) ----------
     Make .pdp-body transparent to layout so its children
     can be reordered alongside the gallery.
     Resulting order:
       0: crumbs
       1: title
       2: GALLERY (images)
       3+: rest of body (price, icons, bullets, desc, dividers)
  ---------------------------------------- */
  .pdp-body{ display: contents !important; }

  .crumbs     { order: 0 !important; }
  .pdp-title  { order: 1 !important; }
  .pdp-gallery{ order: 2 !important; }

  .price-block,
  .icon-row,
  .bullets,
  .pdp-desc,
  .divider{ order: 3 !important; }

  /* 2) HIDE THUMB STRIP, keep only the main image/stack */
  .pdp-gallery{
    display: block !important;      /* not grid/flex on mobile */
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
  }
  .pdp-gallery .pdp-thumbs{ display: none !important; }

  .pdp-main{
    width: 100% !important;
    display: block !important;      /* CRITICAL: ensure container isn't flex/grid */
  }

  /* 3) MAIN IMAGE VIEWPORT (SCROLLER):
        - height driven by CSS var set by JS
        - internal, VISIBLE scroller
        - IMPORTANT: must NOT be flex (or overflow won't scroll reliably on some mobiles)
  */
  #pdpMainWrap{
    position: relative !important;
    display: block !important;

    /* Viewport height = JS-provided frame; fallback keeps page usable before JS runs */
    height: var(--pdp-frame-h, clamp(320px, 62vw, 460px)) !important;

    max-width: 100% !important;
    min-height: 0 !important;

    /* internal scroll */
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    overscroll-behavior: contain !important;
    overscroll-behavior-y: contain !important;
    touch-action: pan-y !important;          /* allow vertical panning inside wrap */
    scrollbar-gutter: stable both-edges;     /* keeps room for a visible bar */

    /* visually match desktop */
    background: #fff !important;
    border: 1px solid #d5d9d9 !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 10px rgba(15,17,17,.06);

    /* layer/paint isolation helps avoid odd overlaps on some mobile browsers */
    z-index: 1;
    contain: paint;
    margin-bottom: 8px; /* space before bullets start */
  }

  /* show scrollbar styling (Chrome/Edge/Android) */
  #pdpMainWrap::-webkit-scrollbar{ width: 10px; height: 10px; }
  #pdpMainWrap::-webkit-scrollbar-thumb{
    background: rgba(15,17,17,.45);
    border-radius: 10px;
  }
  #pdpMainWrap::-webkit-scrollbar-track{ background: transparent; }
  /* Firefox */
  #pdpMainWrap{ scrollbar-width: thin; scrollbar-color: rgba(15,17,17,.45) transparent; }

  /* NEW: stacked scroller container + items */
  #pdpStack{
    display: block !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  #pdpStack img{
    display: block !important;
    width: 100% !important;
    height: var(--pdp-frame-h, auto) !important;  /* all images share the same frame height */
    max-width: 100% !important;
    max-height: none !important;
    object-fit: contain !important;               /* larger images auto-size inside the frame */
    object-position: center center !important;
    margin: 0 auto !important;
    user-select: none !important;
    -webkit-user-drag: none !important;
    touch-action: pan-y !important;
    pointer-events: auto !important;
  }
  /* âœ… Make video frame match the same fixed height/centering as images */
  #pdpStack video{
    display: block !important;
    width: 100% !important;
    height: var(--pdp-frame-h, auto) !important;
    max-width: 100% !important;
    max-height: none !important;
    object-fit: contain !important;
    object-position: center center !important;
    margin: 0 auto !important;
    user-select: none !important;
    -webkit-user-drag: none !important;
    touch-action: pan-y !important;
    pointer-events: auto !important;
  }

  /* Legacy single-media nodes â€” keep neutral so JS can hide/show as needed */
  #pdpMainImg,
  #pdpMainVideo{
    max-width: 100% !important;
    height: auto !important;
    max-height: none !important;
    object-fit: contain !important;
    margin: 0 auto !important;
  }
  #pdpMainVideo{ display: none !important; } /* usually off on mobile */

  /* ðŸ”’ When stacked scroller is active, hide legacy nodes to avoid duplicates */
  #pdpMainWrap[data-stack-applied="1"] #pdpMainImg,
  #pdpMainWrap[data-stack-applied="1"] #pdpMainVideo{
    display: none !important;
  }

  /* Prevent *any* stacking overlap with following sections */
  .pdp-leftgrid > section:not(.pdp-gallery),
  .bullets, .pdp-desc, .divider{
    position: relative !important;
    z-index: 0 !important;
    clear: both !important;
  }

  /* 4) BUY GADGET under image, full width, DESKTOP COLORS */
  .buybox{
    order: 99 !important;           /* keep buybox clearly after content */
    position: static !important;
    top: auto !important;
    transform: none !important;

    width: 100% !important;
    max-width: 100% !important;

    background: #fff !important;
    border: 1px solid #d5d9d9 !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 10px rgba(15,17,17,.12) !important;
    font-size: 14px; /* same as your mobile rule in pdp-buybox.css */
  }

  .buybox .btn{
    width: 100% !important;
    padding: 12px 16px !important;
    font-size: 16px !important;
    border-radius: 999px !important;
  }
  .buybox .btn + .btn{ margin-top: 8px !important; }

  /* 5) Avoid duplicate price UI: hide BODY price-block (buybox shows price+qty+CTAs+sold/fulfilled) */
  .price-block{ display: none !important; }

  /* 6) WRAPPING: title and bullets must wrap nicely */
  .pdp-title{
    white-space: normal !important;
    overflow-wrap: anywhere !important;
    word-break: break-word !important;
    font-size: 18px !important;
    line-height: 1.28 !important;
    margin: 6px 0 10px !important;
    font-weight: 700 !important;
  }

  .bullets,
  .bullets li,
  .pdp-desc{
    white-space: normal !important;
    overflow-wrap: anywhere !important;
    word-break: break-word !important;
    line-height: 1.38 !important;
  }

  /* Small spacing polish */
  .divider{ margin: 10px 0 !important; }
}
